{% embed 'partials/base.html.twig' %}

{% set collection = page.collection() %}
{% set collection_type = page.header.list_of %} {# 'type' or 'event' #}

{% set taxlist = taxonomylist.get() %}

{% block head %}

{{ parent() }}

<script>
$(window).on('load', function() {

  // init Isotope
  var $container = $('.isotope').isotope({
    itemSelector: '.element-item',
    layoutMode: 'masonry'
  });

  // bind filter button click
  $('#filters').on('click', 'button', function() {
    var filterValue = $(this).attr('data-filter');
    $container.isotope({
      filter: filterValue
    });
  });

  // change is-checked class on buttons
  $('.buttons').each(function(i, buttonGroup) {
    var $buttonGroup = $(buttonGroup);
    $buttonGroup.on('click', 'button', function() {
      $buttonGroup.find('.active').removeClass('active');
      $(this).addClass('active');
    });
  });
});
</script>

<style type="text/css">
  .main.container {
    margin-top: 7em;
  }
/* Transition fix for Semantic UI Cards & Isotope filtering */
.ui.cards > .card, .ui.card {
    transition: none;
}
</style>

{% endblock %}

{% block content %}

{{ page.content }}

<!-- button filter list -->
{% if taxlist %}
<div class="ui horizontal divider"></div>

<div id="filters" class="ui buttons">
  <button class="ui basic button active" data-filter="*">All</button>
  {% for tax,value in taxlist['tag'] %}
  <button class="ui basic button" data-filter=".tag-{{tax|replace(' ','-')}}">{{ tax }}</button>
  {% endfor %}
</div>
{% endif %}
<!-- end button filter list -->

<div class="ui horizontal divider"></div>

<!-- cards list (filterable) -->
<div class="segment">
  <div class="ui cards isotope">
  {% for child in collection %}
    {% include 'partials/workshop_%s_item.html.twig'|format(collection_type) with {'list':page, 'page':child, 'truncate':true} %}
  {% endfor %}
  </div>
</div>
<!-- end cards list (filterable) -->

{% endblock %}

{% endembed %}


